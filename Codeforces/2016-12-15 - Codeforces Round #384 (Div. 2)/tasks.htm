<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="e0b2ae4fab4fa52dfbfc2f72f832eba6">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <script type="text/javascript" async="" src="tasks_files/ga.js"></script><script type="text/javascript" src="tasks_files/jquery-1.js"></script>
    <script type="application/javascript">
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }
    </script>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="c3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="http://st.codeforces.com/s/49907/images/codeforces-telegram-square.png">
    <link rel="image_src" href="http://st.codeforces.com/s/49907/images/codeforces-telegram-square.png">
    <meta property="og:title" content="Задачи - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Задачи - Codeforces</title>
        <meta name="description" content="Codeforces. Соревнования и олимпиады по информатике и программированию, сообщество программистов">
        <meta name="keywords" content="программирование информатика контест олимпиада алгоритмы c++ java графы vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="tasks_files/font-awesome.css" type="text/css" charset="utf-8">

        <link href="tasks_files/css.css" rel="stylesheet" type="text/css">
        <link href="tasks_files/css_002.css" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="http://st.codeforces.com/s/49907/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="tasks_files/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/jquery_003.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/jquery_004.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/jquery_002.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/codeforces.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/jquery.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="tasks_files/community.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="tasks_files/sidebar-menu.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="tasks_files/prettify.js"></script>
    <script type="text/javascript" src="tasks_files/moment.js"></script>
    <script type="text/javascript" src="tasks_files/pushstream.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_009.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_012.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_007.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_006.js"></script>
    <script type="text/javascript" src="tasks_files/facebox.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_013.js"></script>
    <script type="text/javascript" src="tasks_files/wysiwyg.js"></script>
    <script type="text/javascript" src="tasks_files/wysiwyg_002.js"></script>
    <script type="text/javascript" src="tasks_files/wysiwyg_004.js"></script>
    <script type="text/javascript" src="tasks_files/wysiwyg_003.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_010.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_005.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_011.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_004.js"></script>
    <script type="text/javascript" src="tasks_files/jquery_008.js"></script>
    <script type="text/javascript" src="tasks_files/jquery.js"></script>
    <script type="text/javascript" src="tasks_files/sjcl.js"></script>
    <script type="text/javascript" src="tasks_files/codeforces-options.js"></script>
    <script type="text/javascript" src="tasks_files/codeforces.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="tasks_files/style_003.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="tasks_files/style_002.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="tasks_files/share.js" charset="utf-8"></script>

    <script type="text/javascript" src="tasks_files/jquery_002.js"></script>
    <script type="text/javascript" src="tasks_files/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->

        <script type="text/javascript" src="tasks_files/jquery_003.js"></script>
        <script src="tasks_files/openapi.js" type="text/javascript"></script>

</head>
<body><span style="display:none;" class="csrf-token" data-csrf="e0b2ae4fab4fa52dfbfc2f72f832eba6">&nbsp;</span>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile == "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>
<script type="text/javascript">
    VK.init({apiId: 1961905});
</script>
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 1000
        });
    }, 0);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }
        console.log("Got announcement from channel");
        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "ru");
        }, Math.random() * 500);
    }
    if (Codeforces.getParticipantChannel()) {
        Codeforces.subscribe(Codeforces.getParticipantChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    if (Codeforces.getContestChannel()) {
        Codeforces.subscribe(Codeforces.getContestChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    if (Codeforces.getGlobalChannel()) {
        Codeforces.subscribe(Codeforces.getGlobalChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    if (Codeforces.getUserChannel()) {
        Codeforces.subscribe(Codeforces.getUserChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    $(".clickable-title").click(function() {
        Codeforces.alert($(this).attr("title"));
    }).css("position", "relative").css("bottom", "3px");


    Codeforces.reformatTimes();
    Codeforces.initializePubSub();

    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<div id="body">
<div style="width: 950px; margin: 0 auto;">
    <div id="header" style="position: relative;">
        <div style="float:left;">
                 <a href="http://codeforces.com/"><img src="tasks_files/codeforces-logo-with-telegram.png"></a>
        </div>
        <div class="lang">
            <div style="text-align: right;">
                <a href="http://codeforces.com/contest/743/problems?locale=en"><img src="tasks_files/gb.png" title="In English" alt="In English"></a>
                <a href="http://codeforces.com/contest/743/problems?locale=ru"><img src="tasks_files/ru.png" title="По-русски" alt="По-русски"></a>
            </div>
        </div>
        <br style="clear: both;">
    </div>

    <div style="text-align: center; font-size: 1.8rem; margin-bottom: 0.5em;" class="caption">Codeforces Round #384 (Div. 2)</div>
    <div style="border-top: 1px solid #ccc; height: 1em;"></div>

        <div style="margin-bottom: 4em;page-break-after: always;">

<div class="problemindexholder" problemindex="A">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">A. Владик и перелеты</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Владик&nbsp;—
 спортивный программист. В этом году он собирается победить на 
международной олимпиаде школьников по информатике. Но все не так просто,
 как кажется: перед Владиком стоит вопрос, как выгоднее всего добраться 
до места проведения олимпиады. </p><p>Владику известно <span class="tex-span"><i>n</i></span> аэропортов. Все аэропорты расположены на одной прямой. Каждый аэропорт имеет свой уникальный порядковый номер от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>, дом Владика находится возле аэропорта с номером <span class="tex-span"><i>a</i></span>, а место проведения олимпиады&nbsp;— рядом с аэропортом, имеющим номер <span class="tex-span"><i>b</i></span>. Дом Владика и место проведения олимпиады могут находиться возле одного и того же аэропорта. </p><p>Чтобы
 добраться до олимпиады, Владик может совершить любое количество 
промежуточных перелетов, однако он должен начать в аэропорте <span class="tex-span"><i>a</i></span> и завершить свой полет в аэропорте <span class="tex-span"><i>b</i></span>.</p><p>Каждый аэропорт принадлежит ровно одной из двух обслуживающих компаний. Стоимость перелета из аэропорта с номером <span class="tex-span"><i>i</i></span> в аэропорт с номером <span class="tex-span"><i>j</i></span> равняется нулю, если эти аэропорты принадлежат одной компании, и <span class="tex-span">|<i>i</i> - <i>j</i>|</span>, если они принадлежат разным компаниям.</p><p>Найдите минимальную стоимость, за которую Владик может долететь на олимпиаду.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных записаны три целых числа <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>a</i></span>, и <span class="tex-span"><i>b</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">5</sup></span>, <span class="tex-span">1 ≤ <i>a</i>, <i>b</i> ≤ <i>n</i></span>)&nbsp;—
 количество аэропортов, номер аэропорта, из которого Владик начнет свой 
путь, и номер аэропорта, рядом с которым проводится олимпиада. </p><p>Далее записана строка длины <span class="tex-span"><i>n</i></span>, состоящая только из символов <span class="tex-span">0</span> и <span class="tex-span">1</span>. Если на позиции <span class="tex-span"><i>i</i></span> в данной строке стоит <span class="tex-span">0</span>, то <span class="tex-span"><i>i</i></span>-й аэропорт принадлежит первой компании, а иначе&nbsp;— второй компании.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно целое число&nbsp;— минимальную стоимость, за которую Владик может долететь на олимпиаду.</p></div><div class="sample-tests"><div class="section-title">Примеры</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>4 1 4<br>1010<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1</pre></div><div class="input"><div class="title">Входные данные</div><pre>5 5 2<br>10110<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>0</pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере Владик может сперва долететь до аэропорта с номером <span class="tex-span">2</span>, заплатив <span class="tex-span">|1 - 2| = 1</span> единицу стоимости (поскольку аэропорты принадлежат разным компаниями), а затем бесплатно долететь из аэропорта <span class="tex-span">2</span> до <span class="tex-span">4</span> (поскольку аэропорты принадлежат одинаковым компаниям). Таким образом, стоимость такого перелета равна <span class="tex-span">1</span>. Долететь бесплатно невозможно, поэтому ответ на пример равен <span class="tex-span">1</span>. </p><p>Во втором примере Владик может сразу бесплатно долететь из аэропорта <span class="tex-span">5</span> до аэропорта <span class="tex-span">2</span>, поскольку они принадлежат одинаковым компаниям.</p></div></div><p>  </p></div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")
                && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")
                && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
        </div>
        <div style="margin-bottom: 4em;page-break-after: always;">

<div class="problemindexholder" problemindex="B">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">B. Хлоя и последовательность</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Хлоя, как и Владик,&nbsp;— спортивный программист. У нее не было проблем с тем, чтобы добраться до олимпиады, но на самой олимпиаде ей понадобилась ваша помощь! У нее не получается решить следующую задачу.</p><p>Рассмотрим следующий алгоритм генерации последовательностей целых чисел. Первоначально имеется последовательность из одного элемента, равного <span class="tex-span">1</span>. Далее производится <span class="tex-span">(<i>n</i> - 1)</span> шаг. На каждом шаге берется последовательность, полученная на предыдущем шаге, приписывается сама к себе в конец, а в середину вставляется символ с минимальным положительным, не использованным ранее, числом. Например, после первого шага получится последовательность <span class="tex-span">[1, 2, 1]</span>, а после второго&nbsp;— <span class="tex-span">[1, 2, 1, 3, 1, 2, 1]</span>.</p><p>Необходимо вывести значение элемента, стоящего на <span class="tex-span"><i>k</i></span>-й позиции (элементы пронумерованы с <span class="tex-span">1</span>) в итоговой последовательности, т.&nbsp;е. после <span class="tex-span">(<i>n</i> - 1)</span> шага. Помогите Хлое решить задачу!</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке содержатся два целых числа <span class="tex-span"><i>n</i></span> и <span class="tex-span"><i>k</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 50</span>, <span class="tex-span">1 ≤ <i>k</i> ≤ 2<sup class="upper-index"><i>n</i></sup> - 1</span>).</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно целое число&nbsp;— число, стоящее в итоговой последовательности на позиции <span class="tex-span"><i>k</i></span>.</p></div><div class="sample-tests"><div class="section-title">Примеры</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3 2<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2</pre></div><div class="input"><div class="title">Входные данные</div><pre>4 8<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>4</pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере итоговая последовательность&nbsp;— <span class="tex-span">[1, 2, 1, 3, 1, 2, 1]</span>. Число, стоящее на второй позиции, равно <span class="tex-span">2</span>.</p><p>Во втором примере итоговая последовательность&nbsp;— <span class="tex-span">[1, 2, 1, 3, 1, 2, 1, 4, 1, 2, 1, 3, 1, 2, 1]</span>. Число на восьмой позиции &nbsp;— <span class="tex-span">4</span>.</p></div></div><p>  </p></div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")
                && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")
                && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
        </div>
        <div style="margin-bottom: 4em;page-break-after: always;">

<div class="problemindexholder" problemindex="C">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">C. Владик и дроби</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>1 секунда</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Владик и Хлоя решили определить, кто из них лучше разбирается в математике. Владик заявил, что сможет для любого положительного целого <span class="tex-span"><i>n</i></span> представить дробь вида <img class="tex-formula" src="tasks_files/7ea334dc5ba22c666c8f87f28a3dbd96119e1bbd.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> в виде суммы трех попарно различных положительных дробей вида <img class="tex-formula" src="tasks_files/0e203d54bfbb1cc777cf935c83d40b57e96ec58d.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">.</p><p>Помогите Владику сделать это, то есть найти для заданного <span class="tex-span"><i>n</i></span> три различных положительных целых числа <span class="tex-span"><i>x</i></span>, <span class="tex-span"><i>y</i></span> и <span class="tex-span"><i>z</i></span> такие, что <img class="tex-formula" src="tasks_files/436aaafa23e0ed17d16e5e10aab481e508f74c7c.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle">. Так как Хлоя не сможет проверить ответ Владика, если эти числа будут слишком большие, он просит вас вывести числа не превосходящие <span class="tex-span">10<sup class="upper-index">9</sup></span>.</p><p>Если подходящего ответа не существует, выведите <span class="tex-font-style-tt">-1</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В единственной строке содержится одно целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 10<sup class="upper-index">4</sup></span>).</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если решение существует, выведите <span class="tex-span">3</span> различных целых числа <span class="tex-span"><i>x</i></span>, <span class="tex-span"><i>y</i></span> и <span class="tex-span"><i>z</i></span> (<span class="tex-span">1 ≤ <i>x</i>, <i>y</i>, <i>z</i> ≤ 10<sup class="upper-index">9</sup></span>, <span class="tex-span"><i>x</i> ≠ <i>y</i></span>, <span class="tex-span"><i>x</i> ≠ <i>z</i></span>, <span class="tex-span"><i>y</i> ≠ <i>z</i></span>). Иначе выведите <span class="tex-font-style-tt">-1</span>.</p><p>Если существует несколько решений, выведите любое из них.</p></div><div class="sample-tests"><div class="section-title">Примеры</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2 7 42<br></pre></div><div class="input"><div class="title">Входные данные</div><pre>7<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>7 8 56<br></pre></div></div></div></div><p>  </p></div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")
                && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")
                && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
        </div>
        <div style="margin-bottom: 4em;page-break-after: always;">

<div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Хлоя и приятные подарки</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Щедрые спонсоры олимпиады, в которой участвуют Хлоя и Владик, разрешили всем участникам выбрать себе приз самостоятельно. Так как близится Новый год, спонсоры решили нарядить новогоднюю елку своими призами. </p><p>Они взяли <span class="tex-span"><i>n</i></span> подарков для участников и на каждом подарке написали его уникальный номер (целое число от <span class="tex-span">1</span> до <span class="tex-span"><i>n</i></span>). Подарок с номером <span class="tex-span"><i>i</i></span> характеризуется целым числом <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>&nbsp;— приятностью подарка. Приятность подарка может быть как положительным, так и отрицательным числом, а так же нулем. Подарок с номером <span class="tex-span">1</span> отправился на вершину елки. Все остальные подарки привязываются веревкой к одному из других подарков так, что каждый подарок в итоге оказывается подвешенным к первому подарку, возможно цепочкой из веревок и других подарков. Более формально, подарки формируют корневое дерево из <span class="tex-span"><i>n</i></span> вершин.</p><p>Раздача подарков происходит таким образом: очередной участник подходит к елке, выбирает любой подарок из оставшихся и отрезает веревку, которой был привязан этот подарок. Обратите внимание, что все веревки, которыми другие подарки были привязаны к подарку, выбранному участником, не отрезаются. Таким образом, участник забирает выбранный подарок, а так же все множество подарков, подвешенное к нему, возможно цепочкой из веревок и других подарков.</p><p>Наши герои, Хлоя и Владик, поделили между собой на олимпиаде первое место и они, вопреки правилам раздачи подарков, будут выходить за подарком вместе! Чтобы не поссориться, они решили выбрать себе два таких различных подарка, что множества подарков, подвешенное к ним цепочкой из веревок и других подарков, не имеют пересечения. Иначе говоря, не должно быть подарка, который был бы подвешен к подарку Хлои и подарку Владика одновременно. Из всех возможных вариантов они выберут такую пару подарков, что сумма приятностей всех подарков, которые достанутся им после того, как они отрежут веревки, максимальна.</p><p>Найдите максимальную сумму приятностей, которую могут забрать себе Хлоя и Владик. Если это по каким-то причинам невозможно, выведите <span class="tex-font-style-tt">Impossible</span>.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входного файла записано одно целое число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 2·10<sup class="upper-index">5</sup></span>)&nbsp;— количество подарков.</p><p>В следующей строке записано <span class="tex-span"><i>n</i></span> целых чисел <span class="tex-span"><i>a</i><sub class="lower-index">1</sub>, <i>a</i><sub class="lower-index">2</sub>, ..., <i>a</i><sub class="lower-index"><i>n</i></sub></span> (<span class="tex-span"> - 10<sup class="upper-index">9</sup> ≤ <i>a</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>)&nbsp;— приятности подарков.</p><p>В следующих <span class="tex-span">(<i>n</i> - 1)</span> строке находятся по два числа. В <span class="tex-span"><i>i</i></span>-й из этих строк находятся целые числа <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>u</i><sub class="lower-index"><i>i</i></sub>, <i>v</i><sub class="lower-index"><i>i</i></sub> ≤ <i>n</i></span>, <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub> ≠ <i>v</i><sub class="lower-index"><i>i</i></sub></span>)&nbsp;— описание ребра дерева. Это означает, что подарки с номерами <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> и <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> привязаны друг к другу веревкой. Эти подарки могут идти в любом порядке: либо <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> привязан к <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>, либо <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> привязан к <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span>. Гарантируется, что все подарки подвешены к первому подарку, возможно цепочкой из веревок и других подарков.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Если Хлоя и Владик смогут выбрать себе подарки, не поссорившись, выведите одно число&nbsp;— максимальную сумму приятностей, которую они смогут забрать в таком случае.</p><p>Иначе выведите строку <span class="tex-font-style-tt">Impossible</span>.</p></div><div class="sample-tests"><div class="section-title">Примеры</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>8<br>0 5 -1 4 3 2 6 5<br>1 2<br>2 4<br>2 5<br>1 3<br>3 6<br>6 7<br>6 8<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>25</pre></div><div class="input"><div class="title">Входные данные</div><pre>4<br>1 -5 1 1<br>1 2<br>1 4<br>2 3<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>2</pre></div><div class="input"><div class="title">Входные данные</div><pre>1<br>-1<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>Impossible</pre></div></div></div></div><p>  </p></div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")
                && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")
                && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
        </div>
        <div style="margin-bottom: 2em;">

<div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Владик и карты</div><div class="time-limit"><div class="property-title">ограничение по времени на тест</div>2 секунды</div><div class="memory-limit"><div class="property-title">ограничение по памяти на тест</div>256 мегабайт</div><div class="input-file"><div class="property-title">ввод</div>стандартный ввод</div><div class="output-file"><div class="property-title">вывод</div>стандартный вывод</div></div><div><p>Владик заскучал по дороге домой и решил сыграть в следующую игру. Он взял <span class="tex-span"><i>n</i></span> карт и положил их в ряд перед собой. На каждой карте Владика написано целое положительное число, не превосходящее <span class="tex-span">8</span>. Он решил найти самую длинную подпоследовательность карт, для которой выполняются следующие условия:</p><ul> <li> количество вхождений каждого числа от <span class="tex-span">1</span> до <span class="tex-span">8</span> в подпоследовательности отличается не более, чем на <span class="tex-span">1</span> от количества вхождений любого другого числа. Более формально, если в подпоследовательности <span class="tex-span"><i>c</i><sub class="lower-index"><i>k</i></sub></span> карт с числом <span class="tex-span"><i>k</i></span> на них, то для всех <img class="tex-formula" src="tasks_files/a239431785e56a632b5de514b0a58fd634110473.png" style="max-width: 100.0%;max-height: 100.0%;" align="middle"> выполняется <span class="tex-span">|<i>c</i><sub class="lower-index"><i>i</i></sub> - <i>c</i><sub class="lower-index"><i>j</i></sub>| ≤ 1</span>. </li><li> если в подпоследовательности имеется карта с числом <span class="tex-span"><i>x</i></span>, то все карты с числом <span class="tex-span"><i>x</i></span> должны составлять непрерывный отрезок в этой подпоследовательности (<span class="tex-font-style-bf">но не обязательно быть непрерывным отрезком в исходной последовательности</span>). Например, последовательность карт <span class="tex-span">[1, 1, 2, 2]</span> удовлетворяет данному условию, а <span class="tex-span">[1, 2, 2, 1]</span> — нет. Обратите внимание, что <span class="tex-span">[1, 1, 2, 2]</span> не удовлетворяет первому условию. </li></ul><p>Помогите Владику и найдите максимальную длину подходящей подпоследовательности.</p></div><div class="input-specification"><div class="section-title">Входные данные</div><p>В первой строке входных данных содержится число <span class="tex-span"><i>n</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 1000</span>)&nbsp;— количество карт в последовательности Владика.</p><p>Во второй строке входных данных содержится <span class="tex-span"><i>n</i></span> целых положительных чисел, не превосходящих <span class="tex-span">8</span>&nbsp;— описание последовательности Владика.</p></div><div class="output-specification"><div class="section-title">Выходные данные</div><p>Выведите одно целое число — длину максимальной подпоследовательности, в которой выполняются все условия.</p></div><div class="sample-tests"><div class="section-title">Примеры</div><div class="sample-test"><div class="input"><div class="title">Входные данные</div><pre>3<br>1 1 1<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>1</pre></div><div class="input"><div class="title">Входные данные</div><pre>8<br>8 7 6 5 4 3 2 1<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>8</pre></div><div class="input"><div class="title">Входные данные</div><pre>24<br>1 8 1 2 8 2 3 8 3 4 8 4 5 8 5 6 8 6 7 8 7 8 8 8<br></pre></div><div class="output"><div class="title">Выходные данные</div><pre>17</pre></div></div></div><div class="note"><div class="section-title">Примечание</div><p>В первом примере числа на всех карточках равны, поэтому мы не сможем взять больше, чем одну карточку, поскольку нарушим первое условие.</p></div></div><p>  </p></div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "стандартный ввод")
                && !endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "стандартный вывод")
                && !endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
        </div>

    <br style="clear: both;">

    <div id="footer">
        <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2016 Михаил Мирзаянов</div>
        <div>Соревнования по программированию 2.0</div>

    </div>
</div>


</div><div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div></body></html>